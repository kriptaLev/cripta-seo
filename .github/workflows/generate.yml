name: Generate SEO pages

permissions:
  contents: write
  
on:
  workflow_dispatch:
  push:

jobs:
  generate:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Debug files
        run: |
          echo "Files in repo:"
          ls -la
          echo "keywords.txt content:"
          cat keywords.txt || echo "NO KEYWORDS FILE"

      - name: Generate pages
        run: |
          mkdir -p pages
          n=0

          while IFS= read -r keyword; do
            if [ -z "$keyword" ]; then
              continue
            fi

            n=$((n+1))
            file="pages/page-$n.md"

            echo "# $keyword" > "$file"
            echo "" >> "$file"
            echo "SEO ÑÑ‚Ð°Ñ‚ÑŒÑ Ð¿Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ: $keyword" >> "$file"
            echo "" >> "$file"
            echo "## ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ" >> "$file"
            echo "ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ð¹ Ñ€Ð°Ð·Ð±Ð¾Ñ€ Ñ‚ÐµÐ¼Ñ‹ $keyword Ð´Ð»Ñ Ñ€ÑƒÑÑÐºÐ¾ÑÐ·Ñ‹Ñ‡Ð½Ð¾Ð¹ Ð°ÑƒÐ´Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸." >> "$file"
            echo "" >> "$file"
            echo "## ÐŸÐ¾Ð»ÐµÐ·Ð½Ñ‹Ðµ ÑÑÑ‹Ð»ÐºÐ¸" >> "$file"
            echo "ðŸ‘‰ https://example.com" >> "$file"

          done < keywords.txt

          echo "Generated $n pages"

      - name: Commit pages
        run: |
          git config user.name "seo-bot"
          git config user.email "seo@bot.com"
          git add pages
          git commit -m "Auto-generate SEO pages" || echo "Nothing to commit"
          git push
